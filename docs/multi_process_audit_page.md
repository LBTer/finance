# 前端页面需求文档

## 1. 用户系统

### 1.1 用户角色与职能
- **超级管理员/高级用户**：拥有所有权限
- **普通用户**：根据职能分类
  - 销售用户：创建和管理销售记录
  - 后勤用户：审核和补充订单信息
  - 销售+后勤用户：兼具两种职能

### 1.2 登录注册
- 使用手机号登录
- 管理员和高级用户可创建新用户，需指定角色和职能。
- 其中管理员可以创建高级用户和普通用户，高级用户可以创建普通用户

## 2. 订单管理系统

### 2.1 订单字段
- **基础信息**：订单号、产品名称、类别
- **订单分类**：
  - 订单类型：海外订单(overseas) / 国内订单(domestic)
  - 订单来源：阿里(alibaba) / 国内(domestic) / 展会(exhibition)
- **价格信息**：数量、单价(美元)、总价(美元)、汇率
- **费用信息**：陆运费、海运费、退款、退税、利润(人民币)，这些信息第一次审核前不需要填写
- **其他**：物流公司、备注

### 2.2 5阶段审核流程
1. **第一阶段**：初次创建，信息补充
2. **第二阶段**：待后勤审核
3. **第三阶段**：后勤审核通过，信息补充
4. **第四阶段**：待最终审核
5. **第五阶段**：审核完成

### 2.3 阶段操作权限
- **销售用户**：
  - 创建订单（第一阶段）
  - 提交审核（第一阶段→第二阶段）
  - 撤回自己的订单（第二阶段→第一阶段）
- **后勤用户**：
  - 审核订单（第二阶段→第三阶段）
  - 补充信息（第三阶段）
  - 提交最终审核（第三阶段→第四阶段）
  - 撤回最终审核的提交（第四阶段→第三阶段）
  - 退回订单（第三阶段→第一阶段）
- **高级/超级用户**：
  - 所有权限
  - 最终审核（第四阶段→第五阶段）

## 3. 页面设计需求

### 3.1 订单列表页
- **筛选条件**：阶段、订单类型、订单来源、类别、搜索关键词
- **显示字段**：订单号、产品名称、阶段、订单类型、创建时间、操作按钮
- **分页**：支持分页浏览
- **权限控制**：普通用户只看自己的订单

### 3.2 订单创建/编辑页
- **表单验证**：必填字段验证、格式验证
- **订单分类**：订单类型和来源的级联选择
- **附件上传**：支持销售附件和后勤附件分类
- **阶段控制**：
  - 第一、三阶段：可编辑所有信息
  - 第二、四阶段：不可编辑（审核中）
  - 第五阶段：不可编辑（已完成）

### 3.3 订单详情页
- **信息展示**：完整订单信息、审核历史
- **附件管理**：按类型分组显示，支持下载
- **操作按钮**：根据当前阶段和用户权限显示
- **审核信息**：显示审核人和审核时间

### 3.4 附件管理
- **上传功能**：指定附件类型（销售/后勤）
- **分类显示**：销售附件和后勤附件分开展示
- **权限控制**：根据用户职能控制上传权限

## 4. API接口对接

### 4.1 订单API
```
GET /api/v1/sales - 获取订单列表
POST /api/v1/sales - 创建订单
GET /api/v1/sales/{id} - 获取订单详情
PUT /api/v1/sales/{id} - 更新订单
DELETE /api/v1/sales/{id} - 删除订单
```

### 4.2 附件API
```
POST /api/v1/attachments/upload/{sales_record_id} - 上传附件
GET /api/v1/attachments/{sales_record_id} - 获取附件列表
GET /api/v1/attachments/download/{attachment_id} - 下载附件
DELETE /api/v1/attachments/{attachment_id} - 删除附件
```

### 4.3 用户API
```
POST /api/v1/auth/login - 登录
POST /api/v1/auth/register - 注册用户
GET /api/v1/users/me - 获取当前用户信息
GET /api/v1/users - 获取用户列表
```

### 4.4 统计API
```
GET /api/v1/stats - 获取统计数据
```

## 5. 界面交互要求

### 5.1 状态展示
- 使用颜色区分不同阶段：待审核(橙色)、已通过(绿色)、已完成(蓝色)
- 显示当前操作者和下一步操作提示

### 5.2 权限提示
- 无权限操作时显示灰色按钮并提示
- 阶段流转时显示确认对话框

### 5.3 数据校验
- 前端进行基础数据验证
- 后端错误信息友好显示

## 6. 响应式设计
- 支持PC端和移动端访问
- 表格在小屏幕上支持横向滚动
- 表单布局适配移动设备
